<?xml version="1.0" encoding="utf-8"?>
<mx:Module xmlns:mx="http://www.adobe.com/2006/mxml" 
	xmlns:render="component.Render.*"
	layout="absolute" width="500" height="600"
	 creationComplete="init()" xmlns:Render="component.SurveyUI.Render.*">
	<mx:Script>
		<![CDATA[
		import mx.events.IndexChangedEvent;
		import mx.containers.Canvas;
		import component.SurveyUI.Render.*;
		import mx.rpc.*;
		import mx.rpc.events.*;
		import net.isurvey.event.*;
		import net.isurvey.model.*;
		import com.adobe.cairngorm.control.CairngormEventDispatcher;
		import com.adobe.cairngorm.control.CairngormEvent;
		
		private var md:SurveyModelLocator = SurveyModelLocator.getInstance();
			
		private function init():void{
			pageinfo.text = "Page:"+md.currentpagenumber +"/"+md.totalpagenumber;
		}
		
		public function displayAllSurveyHeads( headlist:* ):void{
			//对应的所有SURVEY的RENDER都在这里创建			
			acSurveyList.removeAllChildren();
			
			for each ( var surveyhead:* in headlist ){
				var surveyRender:Canvas = new Canvas();//TODO:改进为SURVEYRENDER
				surveyRender.label = surveyhead.description;
				acSurveyList.addChild(surveyRender); 
			} 			
		}
		

		public function updatePageNumber(  offset:int ):void{
			var currentPageNumber:int = md.currentpagenumber + offset;
			ppage.enabled = true;
			npage.enabled = true;
			if ( currentPageNumber <= 1 ){
				currentPageNumber = 0;
				ppage.enabled = false;
			}
			else if ( currentPageNumber >= md.totalpagenumber ){
				currentPageNumber = 0;
				npage.enabled = true;
			}		
			md.currentpagenumber = currentPageNumber;
			var event:ControlPanelEvent = new ControlPanelEvent(ControlPanelEvent.PAGE_UPDATE);
			pageinfo.text = "Page:"+md.currentpagenumber +"/"+md.totalpagenumber;	
					
			CairngormEventDispatcher.getInstance().dispatchEvent( event );
		}
		
		public function onSurveyFocusChange( event:IndexChangedEvent ):void{
			trace( event.newIndex );
		}
			
		]]>
	</mx:Script>
	
	
<mx:Canvas  width="100%" height="100%" 
	xmlns:Survey="component.SurveyUI.*">
	<mx:ApplicationControlBar top="0" width="100%" horizontalCenter="0" height="50">
		<mx:Spacer width="10"/>
		<mx:Image source="@Embed(source='images/1.gif')" />
		<mx:Spacer width="120"/>
		<mx:Label text="调查" fontSize="20" fontWeight="bold" textAlign="center" width="100" color="#FFFFFF"/>
	</mx:ApplicationControlBar>
	<mx:Accordion id = "acSurveyList"
		 change="onSurveyFocusChange( event)"
		width="95%" height="80%" horizontalCenter="0" top="70">
		<Render:QuestionRender label="Theme1"/>
		<Render:QuestionRender label="Theme2"/>
		<Render:QuestionRender label="Theme3"/>
<!--		<mx:Canvas label="主题1" width="100%" height="100%">
		</mx:Canvas>
		<mx:Canvas label="主题2" width="100%" height="100%">
		</mx:Canvas>
		<mx:Canvas label="主题3" width="100%" height="100%">
		</mx:Canvas>
		<mx:Canvas label="主题4" width="100%" height="100%">
		</mx:Canvas>-->
	</mx:Accordion>
	
	<mx:LinkButton id="ppage" label="上一页" horizontalCenter="0" 
		click="updatePageNumber(-1)" bottom="20"/>
	<mx:LinkButton id="npage" label="下一页" right="60"
		click="updatePageNumber(1)" bottom="20"/>	
	<mx:Label id="pageinfo" x="286" y="560" text="Page" width="84"/>
</mx:Canvas>
</mx:Module>
